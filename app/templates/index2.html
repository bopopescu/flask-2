<!DOCTYPE html>
<meta charset="utf-8">

<html>
    <head>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='vendor/css/bootstrap.min2.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/fontastic.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='vendor/css/font-awesome.min.css') }}">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/grasp_mobile_progress_circle-1.0.0.min.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='vendor/css/jquery.mCustomScrollbar.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.default.css') }}" id="theme-stylesheet">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <link rel="shortcut icon" href="{{ url_for('static', filename='image/favicon.ico') }}">
        <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
        <!--<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/css/bootstrap.css" rel="stylesheet" type="text/css">-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/css/swiper.min.css">
        <style>
            html, body {
              position: relative;
              height: 100%;
            }
            body {
              <!--background: #eee;-->
              font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
              font-size: 14px;
              color:#000;
              margin: 0;
              padding: 0;
            }
            .swiper-container {
              width: 100%;
              height: 100%;
              margin-left: auto;
              margin-right: auto;
            }
            .swiper-slide {
              text-align: center;
              font-size: 18px;
              background: #fff;
              /* Center slide text vertically */
              display: -webkit-box;
              display: -ms-flexbox;
              display: -webkit-flex;
              display: flex;
               -webkit-box-pack: center;
               -ms-flex-pack: center;
               -webkit-justify-content: center;
              justify-content: center;
               -webkit-box-align: center;
               -ms-flex-align: center;
               -webkit-align-items: center;
              align-items: center;
            }
        </style>
    </head>
    <body>

    <nav class="side-navbar">
      <div class="side-navbar-wrapper">
        <!-- Sidebar Header    -->
        <div class="sidenav-header d-flex align-items-center justify-content-center">
          <!-- User Info-->
          <div class="sidenav-header-inner text-center"><img src="{{ url_for('static', filename='image/sexy.jpg') }}" alt="person" class="img-fluid rounded-circle">
            <h2 class="h5">劉某</h2><span>Web Developer</span>
          </div>
          <!-- Small Brand information, appears on minimized sidebar-->
          <div class="sidenav-header-logo"><a href="/" class="brand-small text-center"> <strong>股</strong><strong class="text-primary">金</strong></a></div>
        </div>
        <!-- Sidebar Navigation Menus-->
        <div class="main-menu">
          <h5 class="sidenav-heading">Main</h5>
          <ul id="side-main-menu" class="side-menu list-unstyled">
            <li><a href="/index2"> <i class="icon-home"></i>首頁                             </a></li>
            <li><a href="/query1"> <i class="fa fa-bar-chart"></i>個股資訊                             </a></li>
            <li><a href="/recommend"> <i class="icon-flask"></i>個股推薦                             </a></li>
            <li><a href="/keep"> <i class="icon-screen"></i>即時追蹤                             </a></li>
            <li><a href="/analysis"> <i class="icon-picture"></i>新聞情感分析                             </a></li>
            <li><a href="/mail"> <i class="icon-mail"></i>聯絡我們                             </a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="page">
    <header class="header">
        <nav class="navbar">
          <div class="container-fluid">
            <div class="navbar-holder d-flex align-items-center justify-content-between">
              <div class="navbar-header">
                  <a id="toggle-btn" href="#" class="menu-btn"><i class="icon-bars"> </i></a>
                  <a href="index.html" class="navbar-brand">
                      <div class="brand-text d-none d-md-inline-block">
                          <span><font size="5">股往</font></span>
                          <strong class="text-primary"><font size="5">金</font></strong>
                          <span><font size="5">來</font></span>
                      </div>

                  </a>
              </div>

                    <ul class="nav navbar-nav navbar-right" style="flex-direction: row;">

                    {% if current_user.is_authenticated %}
                    <li><a href="/auth/logout"><span class="glyphicon glyphicon-log-out"></span> 登出 </a></li>
                    {% else %}
                    <li style="margin-right: 30px;"><a href="/auth/login/user" class="btn btn-info btn-lg"><span class="glyphicon glyphicon-log-in"></span> 登入 </a></li>
                    <li><a href="/auth/register" class="btn btn-info btn-lg"><span class="glyphicon glyphicon-user"></span> 註冊 </a></li>
                    {% endif %}

                </ul>
            </div>
          </div>
        </nav>
      </header>
{% block chart %}
        <div class="swiper-container">
            <div class="swiper-wrapper">
              <div class="swiper-slide"><img src="{{ url_for('static', filename='image/1.jpg') }}"></div>
              <div class="swiper-slide"><img src="{{ url_for('static', filename='image/2.jpg') }}"></div>
              <div class="swiper-slide"><img src="{{ url_for('static', filename='image/3.jpg') }}"></div>
            </div>
            <!-- Add Pagination -->
            <div class="swiper-pagination"></div>
            <!-- Add Arrows -->
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
{% endblock %}
{% block history %}
{% endblock %}
    </div>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/grasp_mobile_progress_circle-1.0.0.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/jquery.cookie.js') }}"> </script>
    <script src="{{ url_for('static', filename='vendor/Chart.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/jquery.validate.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendor/jquery.mCustomScrollbar.concat.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/charts-home.js') }}"></script>
    <!--&lt;!&ndash;<script src="https://code.jquery.com/jquery-3.3.1.js"></script>&ndash;&gt; 這個會擋住front.js-->
    <script src="{{ url_for('static', filename='js/datatables.min.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/js/swiper.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script>
        var swiper = new Swiper('.swiper-container', {
          spaceBetween: 30,
          centeredSlides: true,
          autoplay: {
            delay: 3000,
            disableOnInteraction: false,
          },
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
    </script>
    <script>
      var app = 0;
      var setting = 0;
        function change_button(){
           if (setting == 0) {
                $('.testing[data-id="'+ app +'"]').text('已追蹤');
                setting = 1;
           }
           else if (setting == 1) {
                $('.testing[data-id="'+ app +'"]').text('加入追蹤');
                setting = 0;
           }
        }

        $(document).ready(function() {
            redisdata();
            function redisdata() {
            console.log(111);
                $.ajax({
                    type: 'POST',
                    url: '/keep',
                    contentType: 'application/json; charset=UTF-8',
                    success: function(data){
                        var redisJson = JSON.parse(data);
                            var tr = '';
                            for(var p in redisJson){
                                <!--console.log(redisJson[p]['key']);-->
                                redis_list = redisJson[p]['key'].split(" ")
                                redis_list2 = redis_list[3].split("，")
                                tr += '<tr role="row" class="odd">';
                                tr += '<td class="sorting_1">' + redis_list[1] + '</td>';
                                tr += '<td>' + redis_list[2] + '</td>';
                                tr += '<td>' + redis_list2[0].slice(4, -1) +  '</td>';
                                tr += '<td>' + redis_list2[1].slice(5) + '</td>';
                                tr += '<td>' + redis_list2[2].slice(4, -1) + '</td>';
                                tr += '<td>' + '<button type="button" data-toggle="modal" data-id="'+ p +'" data-target="#myModal" class="testing">加入追蹤</button>' + '</td>';
                                tr += '</tr>';
                            }
                            $("#Andytable").append(tr);
                            $('#AndyisMeOk').DataTable();

                             $('.testing').on('click', function () {
                                var redis_stockname = $(this).parent().siblings('.sorting_1').text();
                                $('.instant-name').html(redis_stockname);
                                app = $(this).attr('data-id');


                              });
                    },
                    error: function(xhr, type) {
                        console.log(xhr.responseText);
                        console.log(type);
                    }
                });
            }
            var t2 = window.setInterval(redisdata,5000);
        } );

<!-- Main File-->

    </script>
    <script src="{{ url_for('static', filename='js/test.js') }}"></script>
    <script src="{{ url_for('static', filename='js/front.js') }}"></script>
    </body>
</html>